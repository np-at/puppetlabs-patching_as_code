function Get-PendingReboot {
    #Copied from http://ilovepowershell.com/2015/09/10/how-to-check-if-a-server-needs-a-reboot/
    #Adapted from https://gist.github.com/altrive/5329377
    #Based on <http://gallery.technet.microsoft.com/scriptcenter/Get-PendingReboot-Query-bdb79542>

    $rebootPending = $false

    if (Get-ChildItem "HKLM:\Software\Microsoft\Windows\CurrentVersion\Component Based Servicing\RebootPending" -EA Ignore) { $rebootPending = $true }
    if (Get-Item "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Auto Update\RebootRequired" -EA Ignore) { $rebootPending = $true }
    if (Get-ItemProperty "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager" -Name PendingFileRenameOperations -EA Ignore) { $rebootPending = $true }
    try {
        $util = [wmiclass]"\\.\root\ccm\clientsdk:CCM_ClientUtilities"
        $status = $util.DetermineIfRebootPending()
        if (($null -ne $status) -and $status.RebootPending) {
            $rebootPending = $true
        }
    }
    catch { }

    # return result
    $rebootPending
}

Get-PendingReboot
# SIG # Begin signature block
# MIIQRgYJKoZIhvcNAQcCoIIQNzCCEDMCAQExCzAJBgUrDgMCGgUAMGkGCisGAQQB
# gjcCAQSgWzBZMDQGCisGAQQBgjcCAR4wJgIDAQAABBAfzDtgWUsITrck0sYpfvNR
# AgEAAgEAAgEAAgEAAgEAMCEwCQYFKw4DAhoFAAQUGDuqlE3JD+ySIHaGvrtTIVZs
# nxGggg2sMIIDEzCCAfugAwIBAgIQGTL85NJsl5lK5oUAs1HT9jANBgkqhkiG9w0B
# AQsFADAcMRowGAYDVQQDExFPRkZMSU5FLVJPT1RDQS1DQTAeFw0xODA1MjMxOTM3
# MTRaFw0yODA1MjMxOTQ3MTNaMBwxGjAYBgNVBAMTEU9GRkxJTkUtUk9PVENBLUNB
# MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAmxlvy0BU2DpM/QOPPli8
# ZHhRzDhF0jZP1NUEIkZiHOqvTIrqAWdIhRulxdpEBpa8gi+TU5pN8GHvZHTgIW9X
# cO/6p34VSuP5gedzxHpCuohXdkVN8shdOgPwd96S+14+WaRVkKmRnnKVv/r7VUo6
# P/iJsYcijpAYRZFm5q400zqnmyoTzE7NJ46N/MB5TQCf8fa11T1G8DRFelRpg55e
# Gn6XcEyVT68tbuIljCKrU8dlq/JsZ5aYyArRouEpFvxernpaZa1nxcqyhzU0gFuz
# WyD/nPKXlybA5tQW++Ki1U87DxQXhwGK+tcgI95HvqEmPQmlmdnE2LGdge6MbDWP
# wQIDAQABo1EwTzALBgNVHQ8EBAMCAYYwDwYDVR0TAQH/BAUwAwEB/zAdBgNVHQ4E
# FgQU5JOP9//t3g48REsTB08jWBx7UmIwEAYJKwYBBAGCNxUBBAMCAQAwDQYJKoZI
# hvcNAQELBQADggEBAJiCUS4juBDP3OWCgUsw5LesSyo424+pCQW2iZN1Sz/aVvP+
# Kf3CxoY7FR5VZisiW2ky/YHdpwC9mOvWA3AAFfHzR/Y5G1+ZSU/p6TyWsds+hcyK
# E5kog1KcIG8jDN18dc4Vf4vzJ0WG3HEntk9gSZT/ifeD+FzDdGLs3JBLVtZGIOHe
# q/H/KqZB4+V4zy1tRwzpfqMNfYB3hziKaFDvVYwQAEKGox7yIgN1uXY55ljle339
# XNZp5RbPR7EuoK2PstzWtGs1chfia8JJ2cSyvMo1U0Jghu6g4VjZlVqbHmZOHfJj
# u45F0p09PwP7plLLzjIC5zb/ipKoszgfBiFbmQwwggRAMIIDKKADAgECAhNGAAAA
# AwwQyTk3R5ZIAAAAAAADMA0GCSqGSIb3DQEBCwUAMBwxGjAYBgNVBAMTEU9GRkxJ
# TkUtUk9PVENBLUNBMB4XDTE4MDUyMzIyNTY0MVoXDTI4MDUyMzE5NDcxM1owTDET
# MBEGCgmSJomT8ixkARkWA29yZzEWMBQGCgmSJomT8ixkARkWBmNmb3JhdDEdMBsG
# A1UEAxMUY2ZvcmF0LUNBLU9OU0lURTEtQ0EwggEiMA0GCSqGSIb3DQEBAQUAA4IB
# DwAwggEKAoIBAQDOHkauJ6B0zRS9PKJ3UUM5PkEbIwdFzITEKMVPpN+ANSE8LYiQ
# i0gzEd4Ksof1WbQzj1m4/6xFlxMDAUFYzPVC9UyAQmFig9n7382zpidwF0zArtNF
# N2iMf1jZciEYANU319JCGSSkH/SB9dhl1NATu3UOPkEH8nvz/TzW3G/oMw8g0VRJ
# e1klWj2JANZ5JJB+d4L2wkVs/8jCDBK/9CCfd8RiR0CE7MorwbQqA40DEeHJomsF
# a6qp/EqbTsAJ3UhkPOJrPJuGne04XaW8jcHZ6dayF6+O90GVJQbqSiNe28IpvxaT
# 8sCIFnzoe9FH/oUJzTKeSfs1rBh7DUkb166PAgMBAAGjggFJMIIBRTAQBgkrBgEE
# AYI3FQEEAwIBADAdBgNVHQ4EFgQUMgIbatqthE+AmScnuOMXK+USvJQwGQYJKwYB
# BAGCNxQCBAweCgBTAHUAYgBDAEEwCwYDVR0PBAQDAgGGMA8GA1UdEwEB/wQFMAMB
# Af8wHwYDVR0jBBgwFoAU5JOP9//t3g48REsTB08jWBx7UmIwTgYDVR0fBEcwRTBD
# oEGgP4Y9aHR0cDovL0NBLW9uc2l0ZTEuY2ZvcmF0Lm9yZy9DZXJ0RW5yb2xsL09G
# RkxJTkUtUk9PVENBLUNBLmNybDBoBggrBgEFBQcBAQRcMFowWAYIKwYBBQUHMAKG
# TGh0dHA6Ly9DQS1vbnNpdGUxLmNmb3JhdC5vcmcvQ2VydEVucm9sbC9vZmZsaW5l
# LXJvb3RDQV9PRkZMSU5FLVJPT1RDQS1DQS5jcnQwDQYJKoZIhvcNAQELBQADggEB
# ADxVsHmIIc7eQyOrNDBrExPU7CYb8lV8Bn9sPLlAqhUpQK6RHGjE8GqODLnNPf3i
# 8Dzk9XmmEJX1JhBT9LWo0rZgBbU38H6FlqKXMuwvVvE8Jox/HO1GUJiP1HdQOwBv
# QfdxDY4Dq6fQjyIkeR5aGcGAEkPLLN8FF2aORjfVXTFKhojkv9TS3tsxeYbslSoc
# S1Z576oB6m4cdtInUht9iLPFNa5//q+k6vV9J5fZ0oR/kMggW1EVYvCVOWETVO98
# VAsK6XzXk9yc+wwIuz0fIobDtr7nq+621+TJE4Dr86gFMxmBlzAQQ92ft+pgmZJE
# wZH0oGwKqR84J22N1WAgdQswggZNMIIFNaADAgECAhMxAAAJ8dioXhvztmUKAAAA
# AAnxMA0GCSqGSIb3DQEBCwUAMEwxEzARBgoJkiaJk/IsZAEZFgNvcmcxFjAUBgoJ
# kiaJk/IsZAEZFgZjZm9yYXQxHTAbBgNVBAMTFGNmb3JhdC1DQS1PTlNJVEUxLUNB
# MB4XDTIxMDMwMjA1NTMxNFoXDTIyMDMwMjA1NTMxNFowZjETMBEGCgmSJomT8ixk
# ARkWA29yZzEWMBQGCgmSJomT8ixkARkWBmNmb3JhdDEPMA0GA1UECxMGQ2ZvckFU
# MQ4wDAYDVQQLEwVTdGFmZjEWMBQGA1UEAxMNTm9haCBQcmFza2luczCCASIwDQYJ
# KoZIhvcNAQEBBQADggEPADCCAQoCggEBALoEquGui7scDK0PszvD2Wmfo8Ozp+eK
# WowAUmDlUoaVK7I9ldKYqdkzZ0Y6scgMO2pzZfk262+CPG5bd7vcOeLIEY19s5xk
# CGCH/SWQoOskeKCMnOteaqEjsXectmAHPl0nZU4/BGwe3t645foP4dZXImTGJgI7
# JvJrqjiDeEycfpJYJSYQNt1KZZQpzc8r0AgCY+oZ9l8RgF/sehGymFGopr+9tVBO
# 61Dp3AeJQUUG4+bGcZfnXabDtbJn2ABLwlO+pNG/U0CZxhFXBNcc4VoWDqCAW57R
# NODprEMw8YB+0G1iBqueAMJvQzsiFfi6tvARMFa4eVeKPQh/knTE7AkCAwEAAaOC
# AwwwggMIMD0GCSsGAQQBgjcVBwQwMC4GJisGAQQBgjcVCIXP9x+HlucKhKmFEYHe
# 31aDlp4oTYHu9TiCv/NnAgFkAgEDMBMGA1UdJQQMMAoGCCsGAQUFBwMDMA4GA1Ud
# DwEB/wQEAwIHgDAbBgkrBgEEAYI3FQoEDjAMMAoGCCsGAQUFBwMDMC8GA1UdEQQo
# MCagJAYKKwYBBAGCNxQCA6AWDBRucHJhc2tpbnNAY2ZvcmF0Lm9yZzAdBgNVHQ4E
# FgQU8gjUGvFaSsir8Chg/NQDN9TQqv8wHwYDVR0jBBgwFoAUMgIbatqthE+AmScn
# uOMXK+USvJQwggEbBgNVHR8EggESMIIBDjCCAQqgggEGoIIBAoaBvWxkYXA6Ly8v
# Q049Y2ZvcmF0LUNBLU9OU0lURTEtQ0EsQ049Q0Etb25zaXRlMSxDTj1DRFAsQ049
# UHVibGljJTIwS2V5JTIwU2VydmljZXMsQ049U2VydmljZXMsQ049Q29uZmlndXJh
# dGlvbixEQz1jZm9yYXQsREM9b3JnP2NlcnRpZmljYXRlUmV2b2NhdGlvbkxpc3Q/
# YmFzZT9vYmplY3RDbGFzcz1jUkxEaXN0cmlidXRpb25Qb2ludIZAaHR0cDovL0NB
# LW9uc2l0ZTEuY2ZvcmF0Lm9yZy9DZXJ0RW5yb2xsL2Nmb3JhdC1DQS1PTlNJVEUx
# LUNBLmNybDCB9AYIKwYBBQUHAQEEgecwgeQwgbIGCCsGAQUFBzAChoGlbGRhcDov
# Ly9DTj1jZm9yYXQtQ0EtT05TSVRFMS1DQSxDTj1BSUEsQ049UHVibGljJTIwS2V5
# JTIwU2VydmljZXMsQ049U2VydmljZXMsQ049Q29uZmlndXJhdGlvbixEQz1jZm9y
# YXQsREM9b3JnP2NBQ2VydGlmaWNhdGU/YmFzZT9vYmplY3RDbGFzcz1jZXJ0aWZp
# Y2F0aW9uQXV0aG9yaXR5MC0GCCsGAQUFBzABhiFodHRwOi8vQ0Etb25zaXRlMS5j
# Zm9yYXQub3JnL29jc3AwDQYJKoZIhvcNAQELBQADggEBAHVAf0vBiYfgAFXZVAh5
# z7OZlolTIeX1gCFu8a77Vn5pyVwtCBjLYMXCyrJQq1A93LvFvz/LeSJpYQnqZ4ef
# 057FVvOrvJFgxwPbwpb/MSd1dUYxNFe9F8u9iIHGHjiJCbopoNMhr+fq5u62Eqpi
# C/C35WPELm3m77/K6aE9Y3IK8VzkbZhd9N7dx4i8sy/EjDn4hqFfkemnEMuqi79v
# i5K/HNxbJGmuAno2U3msKdrRtIkda7SnOnmF9Xf6m7HFl2uOR8ysFdoNUFt0a5MU
# ylTDQeZ6ARLNXwyRFicPvd1qxqzTumqIcgE8BsaHk+eK5KBL3pS/ijN+QnJHm4y0
# 0BMxggIEMIICAAIBATBjMEwxEzARBgoJkiaJk/IsZAEZFgNvcmcxFjAUBgoJkiaJ
# k/IsZAEZFgZjZm9yYXQxHTAbBgNVBAMTFGNmb3JhdC1DQS1PTlNJVEUxLUNBAhMx
# AAAJ8dioXhvztmUKAAAAAAnxMAkGBSsOAwIaBQCgeDAYBgorBgEEAYI3AgEMMQow
# CKACgAChAoAAMBkGCSqGSIb3DQEJAzEMBgorBgEEAYI3AgEEMBwGCisGAQQBgjcC
# AQsxDjAMBgorBgEEAYI3AgEVMCMGCSqGSIb3DQEJBDEWBBSLH29PUvNRas30JIwz
# U4ud3vx3VDANBgkqhkiG9w0BAQEFAASCAQAEyNwyV9U+mK3fIuCg3F3AnI98dZc4
# Dqb36vLERDHDhUj9KMt4A9s/Sk5pZ1T9ayKYA6PnqpM9WvHgkUwA7PKHjRs5hdw7
# bkUBHM53ZE2cN57Ry09baD+W34zd8C6KtMb4wZ17WeJK9TOHOvft/o6MM4tSX53P
# v3lUtrTmJdE+NKug1WbX4juAfbjys7UFETkLWI2RWMcD332Q1ePtTqtM/JSLp9zK
# ZjxfGHqYiF3K2CqcZc67Y673iT21YkB8x1kTUu9PBmjAyi2VurMxjkYr9plQfFtX
# +A7lTYGuZZ5JCdNzwsT8crENRpVQkFrbawmj0DyBURp/zGo2YJVccbQ0
# SIG # End signature block
